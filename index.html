
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>ã‚¹ã‚¿ã‚¸ã‚ªã‚ªã‚ªãƒ†ã‚­çš„å§¿å‹¢åˆ¤å®šãƒ¢ãƒ¼ãƒ‰</title>

<script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils"></script>

</head>
<body>
<div id="result" style="font-size:20px;margin-top:15px;"></div>

<script>
<script>
 
function postureJudge(landmarks){

 const nose = landmarks[0];
 const leftShoulder = landmarks[11];
 const rightShoulder = landmarks[12];
 const leftHip = landmarks[23];
 const rightHip = landmarks[24];

 let messages = [];

 // é¦–ãƒã‚§ãƒƒã‚¯
 const shoulderCenterX = (leftShoulder.x + rightShoulder.x)/2;
 if(Math.abs(nose.x - shoulderCenterX) > 0.05){
   messages.push("ã‚¹ãƒˆãƒ¬ãƒ¼ãƒˆãƒãƒƒã‚¯å‚¾å‘ã‚ã‚Šã§é¦–ãƒ»è‚©ã®ç­‹è‚‰ãŒç·Šå¼µæ°—å‘³ã§ã™");
 } else {
   messages.push(" ã¾ã£ã™ãç«‹ã¦ã¦ã„ã¦ã‚°ãƒƒãƒ‰ã§ã™" );
              
 }

 // è‚©ã®é«˜ã•
 if(Math.abs(leftShoulder.y - rightShoulder.y) > 0.05){
   messages.push("ğŸ”´ è‚©ã®é«˜ã•ã«å·¦å³å·®ãŒã‚ã‚Šã¾ã™");
 } else {
   messages.push("ğŸŸ¢ è‚©ã®é«˜ã•ã¯æƒã£ã¦ã„ã¾ã™");
 }

 // éª¨ç›¤ãƒãƒ©ãƒ³ã‚¹
 if(Math.abs(leftHip.y - rightHip.y) > 0.05){
   messages.push("ğŸ”´ éª¨ç›¤ãŒå‚¾ã„ã¦ã„ã¾ã™");
 } else {
   messages.push("ğŸŸ¢ éª¨ç›¤ãƒãƒ©ãƒ³ã‚¹ã¯è‰¯å¥½ã§ã™");
 }

 document.getElementById("result").innerHTML =
   messages.join("<br>") +
   "<br><br>æ°—ã«ãªã‚‹æ–¹ã¯ã‚¹ã‚¿ã‚¸ã‚ªã‚ªã‚ªãƒ†ã‚­ã§å§¿å‹¢ãƒã‚§ãƒƒã‚¯ãŒãŠã™ã™ã‚ã§ã™ ğŸ™‚";

}
</script>


const leftShoulder = landmarks[11];
const rightShoulder = landmarks[12];
const nose = landmarks[0];

const shoulderCenterX =
(leftShoulder.x + rightShoulder.x)/2;

let result = "è‰¯ã„å§¿å‹¢ãªã®ã§å‘¼å¸ã—ã‚„ã™ã„ã‹ã‚„ã£ã¦ã¿ã¦ãã ã•ã„";

if(Math.abs(nose.x - shoulderCenterX) > 0.03){
result = " çŒ«èƒŒæ°—å‘³ã§ã™ã€‚ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’1ç¨®ç›®ã‚„ã£ã¦ã¿ã¦ãã ã•ã„";
}

document.getElementById("result").innerHTML = result;
}
</script>

<body>

<h2>å†™çœŸã§å§¿å‹¢ãƒã‚§ãƒƒã‚¯</h2>

<input type="file" id="upload" accept="image/*">

<br><br>

<canvas id="canvas"></canvas>

<script>

const upload = document.getElementById("upload");
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

const pose = new Pose({
 locateFile: file => `https://cdn.jsdelivr.net/npm/@mediapipe/pose/${file}`
});

pose.setOptions({
 modelComplexity: 1,
 smoothLandmarks: true
});

pose.onResults(results => {
 ctx.clearRect(0,0,canvas.width,canvas.height);
 ctx.drawImage(results.image,0,0);

 if(results.poseLandmarks){
  drawConnectors(ctx, results.poseLandmarks, POSE_CONNECTIONS);
  drawLandmarks(ctx, results.poseLandmarks);
   document.getElementById("result").innerHTML =
   messages.join("<br>") +
   "<br><br>æ°—ã«ãªã‚‹æ–¹ã¯ã‚¹ã‚¿ã‚¸ã‚ªã‚ªã‚ªãƒ†ã‚­ã§å§¿å‹¢ãƒã‚§ãƒƒã‚¯ãŒãŠã™ã™ã‚ã§ã™ ğŸ™‚";

}


 }
});

upload.onchange = async e=>{
 const img = new Image();
 img.src = URL.createObjectURL(e.target.files[0]);

 img.onload = async ()=>{
  canvas.width = img.width;
  canvas.height = img.height;
  await pose.send({image: img});
 }
}

</script>

</body>
</html>





