
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>姿勢チェック</title>

<script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils"></script>

</head>

<body>

<h2>写真で姿勢チェック</h2>

<input type="file" id="upload" accept="image/*">

<br><br>

<canvas id="canvas"></canvas>

<script>

const upload = document.getElementById("upload");
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

const pose = new Pose({
 locateFile: file => `https://cdn.jsdelivr.net/npm/@mediapipe/pose/${file}`
});

pose.setOptions({
 modelComplexity: 1,
 smoothLandmarks: true
});

pose.onResults(results => {
 ctx.clearRect(0,0,canvas.width,canvas.height);
 ctx.drawImage(results.image,0,0);

 if(results.poseLandmarks){
  drawConnectors(ctx, results.poseLandmarks, POSE_CONNECTIONS);
  drawLandmarks(ctx, results.poseLandmarks);
 }
});

upload.onchange = async e=>{
 const img = new Image();
 img.src = URL.createObjectURL(e.target.files[0]);

 img.onload = async ()=>{
  canvas.width = img.width;
  canvas.height = img.height;
  await pose.send({image: img});
 }
}

</script>

</body>
</html>
